local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local Workspace = game:GetService("Workspace")
local LocalPlayer = Players.LocalPlayer

local autoJogoEnabled = false
local detectionPart = nil
local processed = {}
local DETECTION_SIZE = Vector3.new(14, 10, 1200)
local DETECTION_OFFSET = Vector3.new(0, 3, 0)
local CHECK_INTERVAL = 0.05

local frutas = {
    banana=true, orange=true, apple=true, grape=true,
    watermelon=true, strawberry=true, pineapple=true,
    mango=true, cherry=true, lemon=true, peach=true,
    pear=true, kiwi=true
}

local function ehFruta(nome)
    nome = string.lower(nome)
    if string.find(nome, "bomb") then return false end
    for fruta in pairs(frutas) do
        if string.find(nome, fruta) then
            return true
        end
    end
    return false
end

local function baterNaFruta()
    local minigame = Workspace:FindFirstChild("MinigameCrazykitchen")
    if not minigame then return end
    local remote = minigame:FindFirstChild("üçé2")
    if remote and remote:IsA("RemoteEvent") then
        remote:FireServer()
    end
end

local function removerDetectionPart()
    if detectionPart then
        detectionPart:Destroy()
        detectionPart = nil
    end
end

local function criarDetectionPart()
    removerDetectionPart()
    local char = LocalPlayer.Character
    if not char then return end
    local hrp = char:FindFirstChild("HumanoidRootPart")
    if not hrp then return end
    local part = Instance.new("Part")
    part.Name = "FruitDetector"
    part.Anchored = true
    part.CanCollide = false
    part.Transparency = 0.65
    part.Material = Enum.Material.Neon
    part.Color = Color3.fromRGB(0, 120, 255)
    part.Size = DETECTION_SIZE
    part.Parent = Workspace
    detectionPart = part
end

local overlapParams = OverlapParams.new()
overlapParams.FilterType = Enum.RaycastFilterType.Blacklist
local lastCheck = 0
local connection

local function startDetection()
    connection = RunService.Heartbeat:Connect(function(dt)
        if not autoJogoEnabled or not detectionPart then return end
        lastCheck += dt
        if lastCheck < CHECK_INTERVAL then return end
        lastCheck = 0
        local char = LocalPlayer.Character
        local hrp = char and char:FindFirstChild("HumanoidRootPart")
        if not hrp then return end
        detectionPart.CFrame = hrp.CFrame * CFrame.new(DETECTION_OFFSET)
        overlapParams.FilterDescendantsInstances = { char }
        local parts = Workspace:GetPartsInPart(detectionPart, overlapParams)
        for _, part in ipairs(parts) do
            if not processed[part] and ehFruta(part.Name) then
                processed[part] = true
                baterNaFruta()
            end
        end
    end)
end

local function stopDetection()
    if connection then
        connection:Disconnect()
        connection = nil
    end
    processed = {}
    removerDetectionPart()
end

Tabs.Evento:AddToggle("AutoJogoToggle", {
    Title = "Auto Jogo de Bater em Fruta(quebrado, mas vai ser atualizado)",
    Default = false,
    Callback = function(Value)
        autoJogoEnabled = Value
        if autoJogoEnabled then
            criarDetectionPart()
            startDetection()
            Fluent:Notify({
                Title = "Auto Jogo Ativado",
                Content = "Detectando frutas automaticamente.",
                Duration = 3
            })
        else
            stopDetection()
            Fluent:Notify({
                Title = "Auto Jogo Desativado",
                Content = "Auto jogo desligado.",
                Duration = 3
            })
        end
    end
})

Tabs.Evento:AddParagraph({
    Title = "Informa√ß√µes",
    Content = "Ele bate nas frutas automaticamente, ignorando as bombas."
})

local autoLavaEnabled = false
local autoLavaCoroutine = nil
local bodyPosition = nil
local frozenPosition = nil

local function congelarPlayer()
    local char = Players.LocalPlayer.Character
    if not char then return end
    local hrp = char:FindFirstChild("HumanoidRootPart")
    if not hrp then return end
    frozenPosition = hrp.CFrame.Position
    if not bodyPosition then
        bodyPosition = Instance.new("BodyPosition")
        bodyPosition.MaxForce = Vector3.new(math.huge, math.huge, math.huge)
        bodyPosition.D = 1000
        bodyPosition.P = 10000
        bodyPosition.Parent = hrp
    end
    bodyPosition.Position = frozenPosition
end

local function descongelarPlayer()
    if bodyPosition then
        bodyPosition:Destroy()
        bodyPosition = nil
    end
    frozenPosition = nil
end

local function verificarEDestruirBolaDeFogo()
    local lavaModel = Workspace:FindFirstChild("Lava")
    if not lavaModel then return end
    for _, obj in pairs(lavaModel:GetDescendants()) do
        if obj:IsA("BasePart") and obj.Name == "BolaDeFogo" then
            obj:Destroy()
        end
    end
end

Tabs.Evento:AddToggle("AutoLavaToggle", {
    Title = "Auto Jogo de Lava",
    Default = false,
    Callback = function(Value)
        autoLavaEnabled = Value
        if autoLavaEnabled then
            Fluent:Notify({
                Title = "Auto Lava Ativado",
                Content = "Voc√™ est√° congelado e protegido!",
                Duration = 3
            })
            congelarPlayer()
            autoLavaCoroutine = coroutine.create(function()
                while autoLavaEnabled do
                    verificarEDestruirBolaDeFogo()
                    if frozenPosition and Players.LocalPlayer.Character then
                        local hrp = Players.LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
                        if hrp and bodyPosition then
                            bodyPosition.Position = frozenPosition
                        end
                    end
                    task.wait(0)
                end
            end)
            coroutine.resume(autoLavaCoroutine)
        else
            autoLavaEnabled = false
            descongelarPlayer()
            Fluent:Notify({
                Title = "Auto Lava Desativado",
                Content = "Voc√™ pode se mover novamente!",
                Duration = 3
            })
        end
    end
})

Tabs.Evento:AddParagraph({
    Title = "Informa√ß√µes Auto Lava",
    Content = "Esta fun√ß√£o:\n- Te congela no lugar\n- Deleta automaticamente BolaDeFogo do model Lava\n- Voc√™ fica flutuando se o ch√£o sumir"
})
